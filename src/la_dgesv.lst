
 Lahey/Fujitsu Fortran 95 Compiler Release L6.20b  Thu Dec 15 15:56:24 2005
 Copyright (C) 1994-2003 Lahey Computer Systems.  All rights reserved.
 Copyright (C) 1998-2003 FUJITSU LIMITED. All rights reserved.

 Compilation information
   Current directory : /home/job/src/vasputil
   Source file       : src/la_dgesv.f90
   Compiler options  : --ap -c --chk aesux --chkglobal --nco --dal --ndbl --f95 
                     : -g --nin --info --li --lst --nlong --maxfatals 50 --nml 
                     : --nmldefault --o0 --no --nocl --nopenmp --nparallel 
                     : --nprefetch --pca --nprivate --nquad --quiet --nsav 
                     : --nshared --nsse2 --nstaticlink --nswm --tp 
                     : --nthreadheap --nthreads --trace --trap --nunroll 
                     : --nvarheap --nversion --warn --nwide --nwisk --wo --nzfm 
                     : --xref

 External subroutine subprogram "DGESV_F95"
  (line-no.)(nest)
          1              SUBROUTINE DGESV_F95( A, B, IPIV, INFO )
          2        !
          3        !  -- LAPACK95 interface driver routine (version 3.0) --
          4        !     UNI-C, Denmark; Univ. of Tennessee, USA; NAG Ltd., UK
          5        !     September, 2000
          6        !
          7        !     .. "Use Statements" ..
          8              USE LA_PRECISION, ONLY: WP => DP
          9              USE LA_AUXMOD, ONLY: ERINFO
         10              USE F77_LAPACK, ONLY: GESV_F77 => LA_GESV
         11        !     .. "Implicit Statement" ..
         12              IMPLICIT NONE
         13        !     .. "Scalar Arguments" ..
         14              INTEGER, INTENT(OUT), OPTIONAL :: INFO
         15        !     .. "Array Arguments" ..
         16              INTEGER, INTENT(OUT), OPTIONAL, TARGET :: IPIV(:)
         17              REAL(WP), INTENT(INOUT) :: A(:,:), B(:,:)
         18        !----------------------------------------------------------------------
         19        !
         20        ! Purpose
         21        ! =======
         22        !
         23        !    LA_GESV computes the solution to a real or complex linear system of
         24        ! equations A*X = B, where A is a square matrix and X and B are
         25        ! rectangular matrices or vectors. Gaussian elimination with row
         26        ! interchanges is used to factor A as A = P*L*U , where P is a permutation
         27        ! matrix, L is unit lower triangular, and U is upper triangular. The
         28        ! factored form of A is then used to solve the above system.
         29        !
         30        ! =========
         31        !
         32        !       SUBROUTINE LA_GESV( A, B, IPIV=ipiv, INFO=info )
         33        !          <type>(<wp>), INTENT(INOUT) :: A(:,:), <rhs>
         34        !          INTEGER, INTENT(OUT), OPTIONAL :: IPIV(:)
         35        !          INTEGER, INTENT(OUT), OPTIONAL :: INFO
         36        !       where
         37        !          <type> ::= REAL | COMPLEX
         38        !          <wp>   ::= KIND(1.0) | KIND(1.0D0)
         39        !          <rhs>  ::= B(:,:) | B(:)
         40        !
         41        ! Arguments
         42        ! =========
         43        !
         44        ! A      (input/output) REAL or COMPLEX square array, shape (:,:).
         45        !        On entry, the matrix A.
         46        !        On exit, the factors L and U from the factorization A = P*L*U;
         47        !        the unit diagonal elements of L are not stored.
         48        ! B      (input/output) REAL or COMPLEX array, shape (:,:) with
         49        !        size(B,1) = size(A,1) or shape (:) with size(B) = size(A,1).
         50        !        On entry, the matrix B.
         51        !        On exit, the solution matrix X .
         52        ! IPIV   Optional (output) INTEGER array, shape (:) with size(IPIV) =
         53        !        size(A,1).
         54        !        The pivot indices that define the permutation matrix P; row i of
         55        !        the matrix was interchanged with row IPIV(i).
         56        ! INFO   Optional (output) INTEGER
         57        !        = 0 : successful exit.
         58        !        < 0 : if INFO = -i, the i-th argument has an illegal value.
         59        !        > 0 : if INFO = i, then U(i,i) = 0. The factorization has been
         60        !        completed, but the factor U is singular, so the solution could
         61        !        not be computed.
         62        !        If INFO is not present and an error occurs, then the program is
         63        !        terminated with an error message.
         64        !----------------------------------------------------------------------
         65        !     .. "Parameters" ..
         66              CHARACTER(LEN=7), PARAMETER :: SRNAME = 'LA_GESV'
         67        !     .. LOCAL SCALARS ..
         68              INTEGER :: LINFO, ISTAT, ISTAT1, SIPIV
         69        !     .. "Local Pointers" ..
         70              INTEGER, POINTER :: LPIV(:)
         71        !     .. "Intrinsic Functions" ..
         72              INTRINSIC SIZE, PRESENT, MAX
         73        !     .. "Executable Statements" ..
         74              LINFO = 0; ISTAT = 0
         75     1        IF( PRESENT(IPIV) )THEN
         76     1           SIPIV = SIZE(IPIV)
         77     1        ELSE
         78     1           SIPIV = SIZE(A,1)
         79     1        END IF
         80        !     .. "Test the arguments" ..
         81     1        IF( SIZE( A, 2 ) /= SIZE(A,1) .OR. SIZE(A,1) < 0 ) THEN
         82     1           LINFO = -1
         83     1        ELSE IF( SIZE( B, 1 ) /= SIZE(A,1) .OR. SIZE(B,2) < 0 ) THEN
         84     1           LINFO = -2
         85     1        ELSE IF( SIPIV /= SIZE(A,1) )THEN
         86     1              LINFO = -3
         87     1        ELSE IF ( SIZE(A,1) > 0 ) THEN
         88     2           IF( PRESENT(IPIV) )THEN
         89     2              LPIV => IPIV
         90     2           ELSE
         91     2              ALLOCATE( LPIV(SIZE(A,1)), STAT = ISTAT )
         92     2           END IF
         93     2           IF ( ISTAT == 0 ) THEN
         94     2  !        .. "Call LAPACK77 routine" ..
         95     2              CALL GESV_F77( SIZE(A,1), SIZE(B,2), A, MAX(1,SIZE(A,1)), LPIV, B, MAX(1,SIZE(A,1)), &
         96     2                             LINFO )
         97     2           ELSE
         98     2              LINFO = -100
         99     2           END IF
        100     2           IF( .NOT.PRESENT(IPIV) )THEN
        101     2              DEALLOCATE(LPIV, STAT = ISTAT1 )
        102     2           END IF
        103     1        END IF
        104              CALL ERINFO( LINFO, SRNAME, INFO, ISTAT )
        105              END SUBROUTINE DGESV_F95

 Diagnostic messages: program name(DGESV_F95)
   2004-I: "src/la_dgesv.f90", line 101: 'ISTAT1' is set but never used.

 Procedure information
   Lines      : 105
   Statements : 42

 Scoping unit of external sub-program : DGESV_F95
   Attribute and Cross reference of name
     A
      |(Class and Type) : variable name, REAL(8)
      |(Attributes)     : DIMENSION, INTENT(INOUT), dummy-argument
      |(Declaration)    : 1  17
      |(Definition)     : 95
      |(Reference)      : 78  81  81  81  83  85  87  91  95  95  95
     B
      |(Class and Type) : variable name, REAL(8)
      |(Attributes)     : DIMENSION, INTENT(INOUT), dummy-argument
      |(Declaration)    : 1  17
      |(Definition)     : 95
      |(Reference)      : 83  83  95
     DGESV_F95
      |(Class and Type) : external subroutine name
      |(Attributes)     : 
      |(Declaration)    : 
      |(Definition)     : 1
      |(Reference)      : 105
     DP
      |(Class and Type) : use name
      |(Attributes)     : 
      |(Declaration)    : 
      |(Definition)     : 
      |(Reference)      : 8
     ERINFO
      |(Class and Type) : external subroutine name
      |(Attributes)     : use-associated
      |(Declaration)    : 
      |(Definition)     : 
      |(Reference)      : 9  104
     F77_LAPACK
      |(Class and Type) : module name
      |(Attributes)     : 
      |(Declaration)    : 
      |(Definition)     : 
      |(Reference)      : 10
     GESV_F77
      |(Class and Type) : generic name
      |(Attributes)     : use-associated
      |(Declaration)    : 
      |(Definition)     : 
      |(Reference)      : 10  95
     INFO
      |(Class and Type) : variable name, INTEGER(4)
      |(Attributes)     : INTENT(OUT), OPTIONAL, dummy-argument
      |(Declaration)    : 1  14
      |(Definition)     : 104
      |(Reference)      : 
     IPIV
      |(Class and Type) : variable name, INTEGER(4)
      |(Attributes)     : DIMENSION, INTENT(OUT), OPTIONAL, TARGET, dummy-argument
      |(Declaration)    : 1  16
      |(Definition)     : 
      |(Reference)      : 75  76  88  89  100
     ISTAT
      |(Class and Type) : variable name, INTEGER(4)
      |(Attributes)     : 
      |(Declaration)    : 68
      |(Definition)     : 74  91
      |(Reference)      : 93  104
     ISTAT1
      |(Class and Type) : variable name, INTEGER(4)
      |(Attributes)     : 
      |(Declaration)    : 68
      |(Definition)     : 101
      |(Reference)      : 
     LA_AUXMOD
      |(Class and Type) : module name
      |(Attributes)     : 
      |(Declaration)    : 
      |(Definition)     : 
      |(Reference)      : 9
     LA_GESV
      |(Class and Type) : use name
      |(Attributes)     : 
      |(Declaration)    : 
      |(Definition)     : 
      |(Reference)      : 10
     LA_PRECISION
      |(Class and Type) : module name
      |(Attributes)     : 
      |(Declaration)    : 
      |(Definition)     : 
      |(Reference)      : 8
     LINFO
      |(Class and Type) : variable name, INTEGER(4)
      |(Attributes)     : 
      |(Declaration)    : 68
      |(Definition)     : 74  82  84  86  95  98
      |(Reference)      : 104
     LPIV
      |(Class and Type) : variable name, INTEGER(4)
      |(Attributes)     : DIMENSION, POINTER
      |(Declaration)    : 70
      |(Definition)     : 89  91  95  101
      |(Reference)      : 
     MAX
      |(Class and Type) : intrinsic function name, INTEGER(4)
      |(Attributes)     : INTRINSIC, PURE, ELEMENTAL
      |(Declaration)    : 72
      |(Definition)     : 
      |(Reference)      : 95  95
     PRESENT
      |(Class and Type) : intrinsic function name, LOGICAL(4)
      |(Attributes)     : INTRINSIC, PURE
      |(Declaration)    : 72
      |(Definition)     : 
      |(Reference)      : 75  88  100
     SIPIV
      |(Class and Type) : variable name, INTEGER(4)
      |(Attributes)     : 
      |(Declaration)    : 68
      |(Definition)     : 76  78
      |(Reference)      : 85
     SIZE
      |(Class and Type) : intrinsic function name, INTEGER(4)
      |(Attributes)     : INTRINSIC, PURE
      |(Declaration)    : 72
      |(Definition)     : 
      |(Reference)      : 76  78  81  81  81  83  83  83  85  87  91  95  95  95  95
     SRNAME
      |(Class and Type) : named constant, CHARACTER(7,1)
      |(Attributes)     : 
      |(Declaration)    : 66
      |(Definition)     : 
      |(Reference)      : 104
     WP
      |(Class and Type) : named constant, INTEGER(4)
      |(Attributes)     : use-associated
      |(Declaration)    : 
      |(Definition)     : 
      |(Reference)      : 8  17

 Total information
   Procedures       : 1
   Total lines      : 105
   Total statements : 42

